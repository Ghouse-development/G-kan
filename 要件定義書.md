# G-kan システム要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
G-kan（Gハウス ナレッジマネジメントシステム）

### 1.2 目的
株式会社Gハウスの規則・制度、マニュアル、ルールなどを一元管理し、自然言語検索により誰でも簡単にアクセスできるナレッジ共有システムの構築

### 1.3 技術スタック
- **フロントエンド**: React / Next.js
- **バックエンド**: Supabase
- **データベース**: PostgreSQL (Supabase)
- **認証**: Supabase Auth
- **ストレージ**: Supabase Storage
- **AI検索**: OpenAI API / Anthropic Claude API
- **ホスティング**: Vercel / Supabase
- **バージョン管理**: GitHub (https://github.com/Ghouse-development/G-kan.git)

### 1.4 Supabase設定情報
```
Project URL: https://dtdtexkwbirnpqkwzzxl.supabase.co
Project ID: dtdtexkwbirnpqkwzzxl
Anon Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0ZHRleGt3YmlybnBxa3d6enhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5Mzg2MTMsImV4cCI6MjA3ODUxNDYxM30.7968HUnWd6FyTJgzFKtk3mA4g613-9C2kXfjnLR_kSw
Service Role Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0ZHRleGt3YmlybnBxa3d6enhsIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MjkzODYxMywiZXhwIjoyMDc4NTE0NjEzfQ.KqA8xmhdkaF_kUqk56bckE6tarHH-rPacL7EN4KV7Ak
```

---

## 2. システム目的・解決する課題

### 2.1 現状の課題
- 社内のナレッジが散在している（誰かの頭の中、パソコンの中、各種ツール内）
- 情報検索に時間がかかる
- 成功事例・失敗事例が活かされていない
- 情報が属人化している
- 必要な情報にアクセスできない

### 2.2 システムで実現すること
- **ナレッジの一元化**: 規則、制度、マニュアル、ルールを一箇所に集約
- **高精度検索**: キーワード検索 + AI自然言語検索
- **簡単なアクセス**: 誰でも簡単に必要な情報を見つけられる
- **鮮度の維持**: 常に最新の情報を保つ仕組み
- **知識の共有促進**: メンバー全員が当たり前にナレッジを蓄積・共有

---

## 3. 主要機能要件

### 3.1 【特徴1】ナレッジの一元化

#### 3.1.1 テキストベースのメモ機能
- **概要**: シンプルなテキスト入力でナレッジを記録
- **機能詳細**:
  - リッチテキストエディタ
  - 見出し、箇条書き、表、リンクの挿入
  - 画像・ファイルの添付
  - タグ付け機能
  - カテゴリ分類（規則/制度/マニュアル/ルール）

#### 3.1.2 ファイルのAI自動要約
- **概要**: PowerPoint、Word、Excel、PDF、画像ファイルを添付すると自動で要約
- **機能詳細**:
  - ファイルアップロード（PowerPoint、Word、Excel、PDF、テキスト、画像）
  - AIによる自動要約（3～4行程度）
  - 重要ポイントの自動抽出（10項目程度）
  - ファイル内容の全文検索対応
  - OCR機能（画像内のテキスト読み取り）

#### 3.1.3 メールの自動転送機能
- **概要**: メールを自動的にG-kanに取り込み
- **機能詳細**:
  - 専用メールアドレスへの転送設定
  - メール内容の自動記事化
  - 添付ファイルの自動保存
  - 送信者・受信者情報の記録

#### 3.1.4 チャット連携機能
- **概要**: Slack/Teamsから重要な情報をワンクリックで取り込み
- **機能詳細**:
  - Slack/Teams連携ボタン
  - メッセージのワンクリック保存
  - スレッド形式での保存
  - 添付ファイルの同時保存

### 3.2 【特徴2】超高精度検索

#### 3.2.1 キーワード検索
- **概要**: 高速・高精度のキーワード検索
- **機能詳細**:
  - 平均0.2秒の高速検索
  - 複数キーワード対応（AND/OR検索）
  - タグ検索
  - フォルダ検索
  - 添付ファイル内検索
  - OCR検索（画像内テキスト）
  - 検索履歴の保存
  - よく検索されるキーワードのランキング表示

#### 3.2.2 AI自然言語検索
- **概要**: 質問形式で自然言語検索が可能
- **機能詳細**:
  - 完全な自然言語での質問受付
  - AIによる回答生成
  - 参考元ナレッジの明示
  - 会話形式での追加質問対応
  - 検索結果のランキング表示

#### 3.2.3 チーム辞書機能
- **概要**: 会社独自の用語を登録し、検索精度を向上
- **機能詳細**:
  - 同義語の登録（例：「第1営業部」=「田中部」=「営1」）
  - 略語の登録
  - 業界用語の登録
  - 自動補完機能

### 3.3 【特徴3】ナレッジ蓄積の促進

#### 3.3.1 社内版知恵袋（Q&A機能）
- **概要**: 社内の有識者に質問できる機能
- **機能詳細**:
  - 質問の投稿
  - 回答の投稿（複数回答可）
  - 匿名質問機能
  - ベストアンサーの選定
  - 質問・回答のいいね機能
  - 質問のカテゴリ分類

#### 3.3.2 ホーム画面
- **概要**: 最新情報を一覧表示
- **機能詳細**:
  - 管理者からのお知らせ
  - 最新の記事
  - 最新の質問
  - 最新の検索キーワード
  - 各種ランキング（閲覧数、いいね数など）
  - リアルタイム更新

#### 3.3.3 リアクション機能
- **概要**: SNS感覚でいいね・リアクションが可能
- **機能詳細**:
  - 複数種類のリアクション（いいね、参考になった、など）
  - リアクション数の表示
  - リアクションした人の表示
  - リアクション通知
  - 週次でのリアクション数レポート

#### 3.3.4 ナレッジメルマガ
- **概要**: 月次で利用状況をメール配信
- **機能詳細**:
  - 個人の閲覧数（チーム内での順位付き）
  - 管理者からのお知らせ
  - 閲覧された記事ランキング
  - 閲覧獲得メンバーランキング
  - 最新の質問
  - 自動配信（月1回）

### 3.4 【特徴4】正確でフレッシュな情報管理

#### 3.4.1 重複判定機能（AI）
- **概要**: 新規投稿時に既存情報との重複をAIが検知
- **機能詳細**:
  - 記事内容の類似度チェック
  - ファイル内容の類似度チェック
  - 重複候補の提示
  - 統合提案

#### 3.4.2 断捨離機能（AI）
- **概要**: 一定期間使われていない情報をAIが検知
- **機能詳細**:
  - 閲覧されていない記事の自動検知
  - 更新されていない記事の自動検知
  - 削除候補の提示
  - アーカイブ機能

#### 3.4.3 承認機能
- **概要**: 重要な情報は承認フローを設定可能
- **機能詳細**:
  - フォルダ単位での承認設定
  - 多段階承認対応
  - 承認者の指定
  - 承認依頼通知
  - 承認履歴の記録

#### 3.4.4 編集履歴・バージョン管理
- **概要**: すべての変更履歴を自動保存
- **機能詳細**:
  - 全編集履歴の自動保存
  - 任意の時点への復元
  - 変更差分の表示
  - 編集者・編集日時の記録

### 3.5 【特徴5】運用サイクル管理

#### 3.5.1 利用状況レポート
- **概要**: 利用状況をリアルタイムで確認
- **機能詳細**:
  - チーム全体の利用状況
  - グループ別の利用状況
  - ユーザー別の利用状況
  - 記事/質問別の利用状況
  - 検索履歴
  - CSV出力機能

#### 3.5.2 アクセスログ
- **概要**: 誰がいつ何にアクセスしたかを記録
- **機能詳細**:
  - ログイン履歴
  - 閲覧履歴
  - 編集履歴
  - 検索履歴
  - ダウンロード履歴

---

## 4. アクセス権限・セキュリティ要件

### 4.1 フォルダ単位のアクセス制限
- **機能詳細**:
  - フォルダごとにアクセス可能なユーザー/グループを設定
  - 「編集可能」「閲覧のみ」の権限設定
  - 多階層フォルダ対応
  - 権限の継承設定

### 4.2 閲覧のみ権限
- 特定のユーザーに「閲覧のみ」権限を付与

### 4.3 ファイルダウンロード制限
- スマートフォン/タブレットでのダウンロード制限

### 4.4 認証機能
- **2段階認証**
- **2段階認証の強制**（管理者が設定）
- **IPアドレス制限**
- **SSO（シングルサインオン）**
- **Microsoft Entra ID（旧Azure AD）連携**

### 4.5 セキュリティ対策
- **SSL/TLS暗号化通信**
- **AES256暗号化（データ保存時）**
- **パスワードの不可逆暗号化**
- **アクセスログの記録**
- **定期的なバックアップ**

---

## 5. データベース設計

### 5.1 主要テーブル

#### users（ユーザー）
```sql
- id (uuid, primary key)
- email (text, unique)
- name (text)
- avatar_url (text)
- role (text) -- 'admin', 'editor', 'viewer'
- department (text)
- created_at (timestamp)
- updated_at (timestamp)
```

#### folders（フォルダ）
```sql
- id (uuid, primary key)
- name (text)
- parent_id (uuid, foreign key -> folders.id)
- path (text) -- 階層パス
- created_by (uuid, foreign key -> users.id)
- created_at (timestamp)
- updated_at (timestamp)
```

#### articles（記事）
```sql
- id (uuid, primary key)
- title (text)
- content (text)
- folder_id (uuid, foreign key -> folders.id)
- created_by (uuid, foreign key -> users.id)
- updated_by (uuid, foreign key -> users.id)
- status (text) -- 'draft', 'pending', 'published', 'archived'
- tags (text[])
- view_count (integer)
- created_at (timestamp)
- updated_at (timestamp)
```

#### files（ファイル）
```sql
- id (uuid, primary key)
- article_id (uuid, foreign key -> articles.id)
- file_name (text)
- file_path (text)
- file_size (bigint)
- file_type (text)
- ai_summary (text)
- ai_key_points (jsonb)
- uploaded_by (uuid, foreign key -> users.id)
- created_at (timestamp)
```

#### questions（質問）
```sql
- id (uuid, primary key)
- title (text)
- content (text)
- folder_id (uuid, foreign key -> folders.id)
- is_anonymous (boolean)
- created_by (uuid, foreign key -> users.id)
- view_count (integer)
- created_at (timestamp)
- updated_at (timestamp)
```

#### answers（回答）
```sql
- id (uuid, primary key)
- question_id (uuid, foreign key -> questions.id)
- content (text)
- is_best_answer (boolean)
- created_by (uuid, foreign key -> users.id)
- created_at (timestamp)
- updated_at (timestamp)
```

#### reactions（リアクション）
```sql
- id (uuid, primary key)
- target_type (text) -- 'article', 'question', 'answer'
- target_id (uuid)
- reaction_type (text) -- 'like', 'helpful', etc.
- user_id (uuid, foreign key -> users.id)
- created_at (timestamp)
```

#### comments（コメント）
```sql
- id (uuid, primary key)
- target_type (text) -- 'article', 'question', 'answer'
- target_id (uuid)
- content (text)
- created_by (uuid, foreign key -> users.id)
- created_at (timestamp)
- updated_at (timestamp)
```

#### folder_permissions（フォルダ権限）
```sql
- id (uuid, primary key)
- folder_id (uuid, foreign key -> folders.id)
- user_id (uuid, foreign key -> users.id)
- permission (text) -- 'view', 'edit', 'admin'
- created_at (timestamp)
```

#### search_logs（検索ログ）
```sql
- id (uuid, primary key)
- user_id (uuid, foreign key -> users.id)
- search_query (text)
- search_type (text) -- 'keyword', 'ai_natural'
- results_count (integer)
- created_at (timestamp)
```

#### access_logs（アクセスログ）
```sql
- id (uuid, primary key)
- user_id (uuid, foreign key -> users.id)
- action (text) -- 'view', 'edit', 'delete', 'download'
- target_type (text)
- target_id (uuid)
- ip_address (text)
- user_agent (text)
- created_at (timestamp)
```

#### team_dictionary（チーム辞書）
```sql
- id (uuid, primary key)
- main_term (text)
- synonyms (text[])
- created_by (uuid, foreign key -> users.id)
- created_at (timestamp)
- updated_at (timestamp)
```

#### approvals（承認）
```sql
- id (uuid, primary key)
- article_id (uuid, foreign key -> articles.id)
- approver_id (uuid, foreign key -> users.id)
- status (text) -- 'pending', 'approved', 'rejected'
- comment (text)
- created_at (timestamp)
- updated_at (timestamp)
```

### 5.2 ベクトル検索用テーブル（AI検索用）

#### article_embeddings
```sql
- id (uuid, primary key)
- article_id (uuid, foreign key -> articles.id)
- embedding (vector)
- created_at (timestamp)
```

---

## 6. UI/UX要件

### 6.1 デザインコンセプト
- **シンプル**: ITに詳しくない人でも直感的に使える
- **分かりやすい**: 操作が迷わない
- **高速**: ストレスのないレスポンス

### 6.2 デバイス対応
- **PC**: メイン利用環境
- **スマートフォン**: iOS/Android対応
- **タブレット**: iPad等対応
- **レスポンシブデザイン**: 全デバイスで最適表示

### 6.3 主要画面

#### ホーム画面
- お知らせ
- 最新の記事
- 最新の質問
- 最新の検索キーワード
- 各種ランキング

#### 検索画面
- キーワード検索バー
- AI自然言語検索バー
- 検索履歴
- 検索フィルター（タグ、フォルダ、日付）

#### 記事一覧画面
- フォルダツリー表示
- 記事リスト
- ソート機能（作成日、更新日、閲覧数）
- フィルター機能

#### 記事詳細画面
- タイトル
- 本文
- 添付ファイル
- タグ
- 作成者・作成日
- 更新者・更新日
- コメント欄
- リアクションボタン

#### Q&A画面
- 質問一覧
- 質問詳細
- 回答投稿フォーム
- ベストアンサー表示

#### マイページ
- プロフィール
- 自分の投稿記事
- 自分の質問・回答
- ブックマーク
- 通知設定

#### 管理画面
- ユーザー管理
- フォルダ管理
- 権限設定
- 利用状況レポート
- アクセスログ
- チーム辞書管理

---

## 7. 開発フェーズ

### Phase 1: 基本機能実装（MVP）
**期間**: 1～2ヶ月

#### 実装内容:
- ユーザー認証（Supabase Auth）
- 記事の作成・編集・削除
- フォルダ管理
- キーワード検索
- 基本的なアクセス権限
- レスポンシブUI

#### 成果物:
- 基本的なナレッジ管理が可能なシステム

### Phase 2: 検索機能強化
**期間**: 1～2ヶ月

#### 実装内容:
- AI自然言語検索
- ファイルのAI自動要約
- 添付ファイル内検索
- OCR検索
- チーム辞書機能

#### 成果物:
- 高精度検索が可能なシステム

### Phase 3: コラボレーション機能
**期間**: 1ヶ月

#### 実装内容:
- Q&A機能（社内版知恵袋）
- コメント機能
- リアクション機能
- 通知機能

#### 成果物:
- メンバー間でコラボレーションできるシステム

### Phase 4: 外部連携・自動化
**期間**: 1ヶ月

#### 実装内容:
- メール自動転送機能
- Slack/Teams連携
- 自動メルマガ配信
- ホーム画面の充実

#### 成果物:
- 自動的にナレッジが蓄積されるシステム

### Phase 5: 運用管理機能
**期間**: 1ヶ月

#### 実装内容:
- 重複判定機能（AI）
- 断捨離機能（AI）
- 承認機能
- 利用状況レポート
- アクセスログ

#### 成果物:
- 運用しやすく、品質が保たれるシステム

### Phase 6: セキュリティ強化
**期間**: 2週間

#### 実装内容:
- 2段階認証の強制
- IPアドレス制限
- SSO連携
- ファイルダウンロード制限

#### 成果物:
- エンタープライズレベルのセキュリティを持つシステム

---

## 8. 非機能要件

### 8.1 性能要件
- **検索速度**: 平均0.2秒以内
- **画面表示**: 2秒以内
- **同時接続**: 100名以上

### 8.2 可用性要件
- **稼働率**: 99.9%以上
- **バックアップ**: 日次自動バックアップ
- **障害復旧**: 24時間以内

### 8.3 拡張性要件
- **ユーザー数**: 1000名まで対応
- **ストレージ**: 1TB以上

### 8.4 保守性要件
- **ログ保存**: 1年間
- **データ保持**: 無期限
- **バージョン管理**: Git

---

## 9. 運用要件

### 9.1 サポート体制
- **問い合わせ対応**: メール・チャット
- **利用マニュアル**: オンラインヘルプ
- **FAQ**: よくある質問の整備

### 9.2 トレーニング
- **初期導入研修**: 管理者向け
- **利用者研修**: 全ユーザー向け
- **動画マニュアル**: オンデマンド学習

### 9.3 定期メンテナンス
- **システム更新**: 月次
- **セキュリティパッチ**: 随時
- **データ最適化**: 週次

---

## 10. 成功指標（KPI）

### 10.1 利用率
- **目標**: 登録ユーザーの80%が月1回以上利用
- **測定**: アクティブユーザー数 / 登録ユーザー数

### 10.2 検索成功率
- **目標**: 検索の90%で目的の情報を発見
- **測定**: ユーザーアンケート、検索後の閲覧率

### 10.3 ナレッジ蓄積数
- **目標**: 月間50件以上の新規記事投稿
- **測定**: 新規記事数

### 10.4 業務効率化
- **目標**: 情報検索時間を50%削減
- **測定**: 導入前後のアンケート

### 10.5 満足度
- **目標**: ユーザー満足度80%以上
- **測定**: 定期アンケート

---

## 11. リスク管理

### 11.1 技術的リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| AI検索の精度不足 | 高 | 段階的な学習データの追加、ハイブリッド検索 |
| パフォーマンス低下 | 中 | キャッシング、インデックス最適化 |
| データ損失 | 高 | 自動バックアップ、冗長化 |

### 11.2 運用リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| 利用率が上がらない | 高 | 導入研修、インセンティブ設計 |
| 情報の質が低い | 中 | 承認フロー、ガイドライン整備 |
| セキュリティ事故 | 高 | 定期監査、アクセスログ監視 |

---

## 12. 予算見積もり

### 12.1 開発費用
- **設計・開発**: 約300～500万円（Phase 1～6）
- **デザイン**: 約50～100万円
- **テスト**: 約50万円

### 12.2 運用費用（年間）
- **Supabase**: 約10～20万円/年
- **AI API（OpenAI/Claude）**: 約20～50万円/年
- **ドメイン・SSL**: 約1万円/年
- **保守・サポート**: 約50～100万円/年

---

## 13. スケジュール（全体）

```
Month 1-2:  Phase 1（基本機能実装）
Month 3-4:  Phase 2（検索機能強化）
Month 5:    Phase 3（コラボレーション機能）
Month 6:    Phase 4（外部連携・自動化）
Month 7:    Phase 5（運用管理機能）
Month 7.5:  Phase 6（セキュリティ強化）
Month 8:    テスト・調整
Month 9:    本番リリース
```

---

## 14. 参考資料

### 14.1 ベンチマークツール
- **ナレカン**: https://www.narekan.info/
  - 本要件定義の主な参考ツール
  - 「非IT企業」向けに特化したナレッジマネジメントツール
  - AI機能、自然言語検索、シンプルなUI/UXが特徴

### 14.2 主要機能の参考元
- **ナレッジ一元化**: ナレカンの特徴1
- **AI自然言語検索**: ナレカンの特徴2
- **ナレッジ蓄積促進**: ナレカンの特徴3
- **情報品質管理**: ナレカンの特徴4
- **運用サイクル**: ナレカンの特徴5

---

## 15. まとめ

本システム「G-kan」は、株式会社Gハウスの規則・制度・マニュアル・ルールを一元管理し、AI自然言語検索により誰でも簡単にアクセスできるナレッジ共有システムです。

### 15.1 システムの核心的価値
1. **シンプル**: ITに詳しくなくても使える
2. **高精度検索**: AI自然言語検索で欲しい情報がすぐ見つかる
3. **自動化**: メール転送、チャット連携で自動的にナレッジが蓄積
4. **鮮度維持**: AI支援で常に最新の情報を保つ
5. **セキュア**: エンタープライズレベルのセキュリティ

### 15.2 期待される効果
- **業務効率化**: 情報検索時間50%削減
- **ナレッジの活用**: 成功事例・失敗事例の横展開
- **属人化の解消**: 誰でも必要な情報にアクセス可能
- **組織力強化**: 全員の知識を組織の資産に

---

**作成日**: 2025年11月12日
**作成者**: G-kan プロジェクトチーム
**バージョン**: 1.0
**ステータス**: 初版
